TARGET = libstardust
OBJS = ../Platform/src/Platform/Platform.o \
../Utilities/src/Utilities/Timer.o \
../Utilities/src/Utilities/Logger.o \
../Utilities/src/Utilities/Input.o \
../Utilities/src/Utilities/Thread.o \
../Utilities/src/Utilities/json/json_reader.o \
../Utilities/src/Utilities/json/json_value.o \
../Utilities/src/Utilities/json/json_writer.o \

#../Platform/src/Platform/Platform.o \ 		# Done
#../Platform/src/Platform/PSP/Dialogs.o \
#../Platform/src/Platform/PSP/Power.o \
#../Platform/src/Platform/Graphics.o \
#../Platform/src/Platform/PSP/vram.o \
#../Utilities/src/Platform/Platform.o \
#../Utilities/src/Math/Frustum.o \
#../Utilities/src/Utilities/Timer.o \		# Done
#../Utilities/src/Utilities/Logger.o \		# Done
#../Utilities/src/Utilities/Input.o \		# Done
#../Utilities/src/Utilities/Thread.o \		# Done
#../Utilities/src/Events/Events.o \
#../Utilities/src/Network/NetworkDriver.o \
#../Utilities/src/Network/Socket.o \
#../Utilities/src/Network/ByteBuffer.o \
#../Utilities/src/Profiler/Profiler.o \
#../Utilities/src/Utilities/json/json_reader.o \ # Done
#../Utilities/src/Utilities/json/json_value.o \ # Done
#../Utilities/src/Utilities/json/json_writer.o \ # Done
#../Core/src/Audio/AudioClip.o \
#../Core/src/Core/Core.o \
#../Core/src/Core/StateManager.o \
#../Core/src/GFX/RenderCore.o \
#../Core/src/GFX/2D/Sprite.o \
#../Core/src/GFX/2D/SpriteAnimated.o \
#../Core/src/GFX/2D/Tilemap.o \
#../Core/src/GFX/2D/TilemapAnim.o \
#../Core/src/GFX/3D/Camera.o \
#../Core/src/GFX/3D/Skybox.o \
#../Core/src/GFX/UI/TextRenderer.o \
#../Core/src/GFX/UI/UIButton.o \

INCDIR = -I$(VITASDK)/include
INCDIR += -I../Platform/include -I../Utilities/include -I../Core/include -I../Deps/include

CFLAGS = -O3 -ffast-math
CXXFLAGS = $(CFLAGS) -std=gnu++17 $(INCDIR) -DCURRENT_PLATFORM=PLATFORM_VITA

PREFIX = arm-vita-eabi
CXX = $(PREFIX)-g++
AR = $(PREFIX)-gcc-ar

all: $(TARGET).a
	@mkdir -p lib/vita
	mv $(TARGET).a lib/vita/$(TARGET).a

$(TARGET).a: $(OBJS)
	$(AR) -rc $@ $^

install:
	@mkdir -p $(VITASDK)/$(PREFIX)/lib/
	cp lib/vita/$(TARGET).a $(VITASDK)/$(PREFIX)/lib/

clean:
	@rm -rf $(TARGET).a $(TARGET).elf $(OBJS)